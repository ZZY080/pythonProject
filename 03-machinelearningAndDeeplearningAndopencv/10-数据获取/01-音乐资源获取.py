import requests
import  re
import os

# url ="https://music.163.com/discover/toplist?id=19723756"
url ="https://music.163.com/discover/toplist?id=3779629"
headers = {
"User-Agent":
"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36",
"Cookie":
"_ntes_nnid=ce84c39e766cfdf95cc7c85e616deb49,1661837521523; _ntes_nuid=ce84c39e766cfdf95cc7c85e616deb49; P_INFO=19170376686|1678793913|1|study|00&99|null&null&null#gud&442000#10#0#0|&0|null|19170376686; __bid_n=1878a02e5de85ed2fb4207; amp_adc4c4=NyXZs36BL5q_CefVBteTO4.ZkxTZmtFSUNDTk1XakRvSFhLZHVRVjVldDJ4Mg==..1gu505p1a.1gu505skn.0.2.2; hb_MA-BFF5-63705950A31C_source=www.yanhuangxueyuan.com; FPTOKEN=XpUlKqjegK+J4bD68SI1aIuaXkRI9EqDuQ0f4njHyKrxt4N8YimO/WH7Cr3jUPrWstWNsuRE4tfEJzdaQ5TUziClVqr/7JaF6jgwjyVTWc14lqvy7BV6cGqZN1U4FUBV59D/WPFrpq8NQrjFjz99MwJxsKv/8Sv33Qv5yNeKzkT81+lG9cdpLMxKyAceluKS+nMVf/ydddPdsj+BHtEJl7e6HP2XDokbQKH10ILv3cHvuEA4q8GvkBkHCMB3yVHlm6xCGiFs3129Ae7ySVgGjg8UjmJwGJBmRZvvFyMXY49HM/Im9duCnWm30HPrD/o4dxBx0YYIejTEPTK+kd4hczKwEJliNfKNCyt8EZkTS7fKFumvsbRC8owW6BaInSJtAF7Hno4lI2ertqPJPAuTDQ==|0fLjN9SEWjL1A/obU3vVsDCubRcWDtZ8HIAK8NO52nA=|10|e9d63fb154d47ce2112574feec56446c; NMTID=00Okdu5Fs11p-E1jEUElGuAVzHU8o0AAAGIkDFDCw; _iuqxldmzr_=32; WEVNSM=1.0.0; WNMCID=oqkkps.1686046330271.01.0; WM_TID=LaXMcIIt0r5BREEEVVfUTV4b6h2mAb0C; ntes_utid=tid._.nhXPqWQYJNBEU0EFBRLFxNIADgJ3zQTE._.0; sDeviceId=YD-Nm82uPIHd2BBA1ABFRLAKGOAm%2FZy82Ry; __snaker__id=1vcdOD8mlUdHfbxQ; YD00000558929251%3AWM_NI=R7pu3s7d1Jb7%2FZ%2F%2BXyZJyHRypZ7KgXx%2FY3ztQb4UIFE11BBAge5X6AXGLAgiKkG2Enrd9ibj0IcUjlFmJlMUXSDiWfEK6q36EXk1dd4mT0djn2yNbcgvUGgu1rlB4adnZHM%3D; YD00000558929251%3AWM_NIKE=9ca17ae2e6ffcda170e2e6eea9e74b888c8cb2f143868a8fa2c85f878e9e86d5619b958a8cf860838ca785b52af0fea7c3b92a92e9c096b279f5bcffabe13ded86e1ccdb739a96b7a9d173b486f9ace654bcf197d4f98093befcb6cc4e87efffa3c14ba5bbfbb9b54b9c9984a2e66389b589d3c866b2bcf78ae162f497adb6e96886b3868dd05f9c8d8c8ad66e8795fa92b23e8788a5d2e770f8b39cd1e762aeeeb7afe169a5aa9ba8e67ff3aea4a3b76ba8b296a9d037e2a3; YD00000558929251%3AWM_TID=h7uGdVdSJltEEQVFBBLVNpKdM4sFhE9j; __csrf=ddc3546e8b5f5a2928e1a1e5e2fcf616; __remember_me=true; MUSIC_U=00C2717266AB356820A8072DBA1ED0C4CE747F4B6A6EA7B12A177B5F4D130D5CF8D6623DFB59ABA7F7294B5B115852F48AB11C25446A146A38F789826B116F58B97CD238D7B0223CFC656DBA32826A829856776FE6A46BAA61CE878791B86B2905F47DB4BC9083DC6BF47177F68B182BF86DE171C26C18BBD2FA0C07DD5CBC21F40D0DB8339F32E56D43E524299F813779B948AD8A21EEB088D4BB36044C865B51CF531FF90FDE6E6881DEB543A3FDFA1D2019CC34FB15F5269CCA4D482521F4323D438E373D8277BA06BF2FAC3260C842759B3F4DEF76A2389166955A4411A8EBD1C5ADE4440CC422A74D9F5A86C2339946B5E29F43DDE9C27EFD1A7A29E60D03A77667AB33CF8FF27F647A50BB5D0FF87973D6675E3DFA6298EE46D28EADC2C851CB003CAF4742E734A7F240CDCC989736A76028648D157947288C0DC0A7F18EDF579405218B2C9CFF6B7FF10B7FAB43BB84117BF97517380C6F6F5B7E027F6C; ntes_kaola_ad=1; gdxidpyhxdE=tT9eGmqrTcm%2Flv2zKGi4ZPAZRTBGMB3SxjOLTk3Q5D9dziVfHVXaqTjEv1ikli7hAlE%2BsQy5ZS%2BL5BVJHfDbVX1YD3JB8cGAW8DdXAzxiopSK%5CC5ZUwwEtK48CVa%2F4tro%2BjR96djHYX9rObZuNsimsfMdyvo6MaHrz2ka%2BXHsRpprx40%3A1686189314086; JSESSIONID-WYYY=3wBgfIF337hjMV%2FNKJu6toGDcjA8QAB%5C8OMw2%2Buv5vnXoKskFZAK8AkPDz1S6jVBXC4OzN63Z5Qbzlr2MgqZaKGXTHNi9hhdKroU51upWW8I8A3QAxQRISuRG1McYTE6Y19Ir5BMPKesVfsNGvwAQYOnx0ki0T%5CN2414ftw2XH%2F62zcn%3A1686580038873; WM_NI=yal%2Bgnz5CTOh00spBgeTBD7a%2Fr2rSD%2BFBbrk6ynUp%2F3d7l2V3TpKiIbS58CPboDlFKNzDCBentDBf54u6PIkD3ZVtE02I%2B6z4XkiY7IzCeMtcYY897MKpkX1TLqf95d2Vlk%3D; WM_NIKE=9ca17ae2e6ffcda170e2e6ee9bcf7abab0bad6c84bf78e8fb3d14e878b8eadc461a8b3be92d76a85affc82d42af0fea7c3b92abbbfa4cce666baeb8db5ce64f4f0bd91c16da78c8ea5b66bedaefe93d250e99a8e83f161f6a7a2b6f325f1bcf98db15ef18cc0acec43a28dfbd9c25ca2b18c8dc5418ea68ca4c16faeac8ca3e53ff8abfab1cc6188ed96b7f74ff4ee87ccb572f888a58adc3d8ba68d86d080a18797d9bc3d8f95c08cdb3b9894bf87bc3fa8ee9a8dea37e2a3",
"Pragma":
"no-cache",
"Referer":
"https://www.baidu.com/"
}
response =requests.get(url=url,headers=headers)

html_data = re.findall('<li><a href="/song\?id=(\d+)">(.*?)</a></li>',response.text)
print(html_data)
filename="music\\"
if not os.path.exists(filename):
	os.mkdir(filename)
for num_id,title in html_data:
	music_url = f'http://music.163.com/song/media/outer/url?id={num_id}.mp3'
	music_content = requests.get(url=music_url,headers=headers).content
	with open("music\\"+title+".mp3",mode="wb") as f:
		f.write(music_content)
	print(num_id,title)